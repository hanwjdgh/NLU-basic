# 장단기 메모리(Long Short-Term Memory, LSTM)

가장 단순한 형태의 RNN을 바닐라 RNN(Vanilla RNN)이라고 한다. (케라스에서는 SimpleRNN) 바닐라 RNN 이후 바닐라 RNN의 한계를 극복하기 위한 다양한 RNN의 변형이 나왔고 그 중 하나가 LSTM이다.

## 1. 바닐라 RNN의 한계

바닐라 RNN은 비교적 짧은 시퀀스(sequence)에 대해서만 효과를 보이는 단점, 시점(time-step)이 길어질 수록 앞의 정보가 뒤로 충분히 전달되지 못하는 현상이 발생하는데 이를 장기 의존성 문제(the problem of Long-Term Dependencies)라고 한다.

## 2. LSTM(Long Short-Term Memory)

LSTM은 은닉층의 메모리 셀에 입력 게이트, 삭제 게이트, 출력 게이트를 추가하여 불필요한 기억을 지우고, 기억해야할 것들을 정한다.

은닉 상태(hidden state)를 계산하는 식이 전통적인 RNN보다 조금 더 복잡해졌으며 셀 상태(cell state)라는 값을 추가했다.

### 1. 입력 게이트

입력 게이트는 현재 정보를 기억하기 위한 게이트, 현재 시점 t의 x값과 이전 시점 t-1의 은닉 상태가 시그모이드 함수를 지나 0과 1 사이의 값과 하이퍼볼릭탄젠트 함수를 지나 -1과 1사이의 값 두 개가 나오게 되는데 이 두 개의 값을 가지고 이번에 선택된 기억할 정보의 양을 정한다.

### 2. 삭제 게이트

삭제 게이트는 기억을 삭제하기 위한 게이트, 현재 시점 t의 x값과 이전 시점 t-1의 은닉 상태가 시그모이드 함수를 지나게 됩니다. 시그모이드 함수를 지나면 0과 1 사이의 값이 나오게 되는데, 이 값이 곧 삭제 과정을 거친 정보의 양, 0에 가까울수록 정보가 많이 삭제된 것이고 1에 가까울수록 정보를 온전히 기억한 것이다.

### 3. 셀 상태(장기 상태)

입력게이트에서 구한 두 개의 값에 대해서 원소별 곱을 진행 하고 삭제 게이트의 결과 값과 더한다. 이 값은 다음 t+1 시점의 LSTM 셀로 넘겨진다.

### 4. 출력 게이트와 은닉 상태(단기 상태)

출력 게이트는 현재 시점 t의 x값과 이전 시점 t-1의 은닉 상태가 시그모이드 함수를 지난 값, 해당 값은 현재 시점 t의 은닉 상태를 결정하는 일에 쓰이게 된다.

은닉 상태는 장기 상태의 값이 하이퍼볼릭탄젠트 함수를 지나 -1과 1사이의 값이고 해당 값은 출력 게이트의 값과 연산되면서, 값이 걸러지는 효과가 발생한다. 단기 상태의 값은 또한 출력층으로도 향합니다.
